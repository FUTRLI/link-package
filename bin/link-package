#!/usr/bin/env bash

set -euo pipefail

if [ $# -eq 0 ]; then
    echo "You must provide an argument for the package you wish to link"
    exit 1
fi

PKG_PATH=${WORKSPACE_PATH:-~}
PKG=${PKG_PATH}/${1}/frontend

if [ $1 == "shared-services" ]; then
    PKG=${PKG_PATH}/${1}
fi

(cd ${PKG} && npm run build && cd dist && npm pack)
TARBALL=$(ls ${PKG}/dist/*.tgz)
echo "Installing ${TARBALL}"
npm i ${TARBALL}
